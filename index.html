<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Words App</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0; padding: 0;
        background-color: #f7f7f7;
        color: #333;
    }
    header {
        background-color: #4a90e2;
        color: #fff;
        padding: 15px;
        text-align: center;
        font-size: 1.5em;
    }
    .main-menu, .add-word, .practice, .load-csv, .export-csv, .edit-word {
        display: none;
        padding: 20px;
    }
    button {
        padding: 10px 15px;
        margin: 5px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
    .primary { background-color: #4a90e2; color: #fff; }
    .secondary { background-color: #50e3c2; color: #fff; }
    .option { background-color: #ffe0b2; color: #333; }
    .danger { background-color: #e94b35; color: #fff; }
    input[type="text"] { padding: 8px; width: 80%; margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .word-row { display: flex; align-items: center; justify-content: space-between; margin: 10px 0; }
    .footer {
        text-align: center;
        font-size: 0.7em;
        padding: 10px;
        color: #666;
        background-color: #eee;
        position: fixed;
        bottom: 0; width: 100%;
    }
</style>
</head>
<body>

<header>My Words App</header>

<!-- Main Menu -->
<div class="main-menu">
    <button class="primary" onclick="showSection('add-word')">Add Word</button>
    <button class="primary" onclick="showSection('practice')">Practice Words</button>
    <button class="secondary" onclick="showSection('load-csv')">Load CSV</button>
    <button class="secondary" onclick="exportCSV()">Export CSV</button>
</div>

<!-- Add Word Section -->
<div class="add-word">
    <h2>Add Word</h2>
    <input type="text" id="new-word" placeholder="Enter English word">
    <button class="primary" onclick="translateWord()">Translate Online</button>
    <input type="text" id="translated-word" placeholder="Hebrew Translation">
    <button class="secondary" onclick="saveWord()">Save</button>
    <button class="option" onclick="showSection('main-menu')">Back</button>
    <div id="add-word-msg"></div>
</div>

<!-- Practice Section -->
<div class="practice">
    <h2>Practice Words</h2>
    <label for="practice-count">Select number of words:</label>
    <select id="practice-count">
        <option value="30">Last 30</option>
        <option value="50">Last 50</option>
        <option value="100">Last 100</option>
        <option value="200">Last 200</option>
        <option value="all">All Words</option>
    </select>
    <button class="primary" onclick="startPractice()">Start Practice</button>
    <button class="option" onclick="showSection('main-menu')">Back</button>
</div>

<!-- Word Display / Practice Mode -->
<div class="practice-mode" style="display:none;">
    <div class="word-row">
        <span id="practice-word" style="font-weight:bold;"></span>
        <button class="secondary" onclick="speakWord()" id="speak-btn">ðŸ”Š</button>
        <span id="progress"></span>
    </div>
    <div id="practice-buttons">
        <button class="primary" onclick="nextWord('known')">Next Word</button>
        <button class="option" onclick="showTranslation()">Show Translation</button>
        <button class="option" onclick="showOptions()">Show Options</button>
        <button class="danger" onclick="hideWord()">Hide</button>
        <button class="secondary" onclick="editCurrentWord()">Edit Word</button>
        <button class="danger" onclick="deleteCurrentWord()">Delete</button>
    </div>
    <div id="options-container" style="margin-top:10px;"></div>
    <div id="practice-msg"></div>
</div>

<!-- Load CSV -->
<div class="load-csv">
    <h2>Load CSV File</h2>
    <input type="file" id="csv-file">
    <button class="primary" onclick="loadCSV()">Load CSV</button>
    <button class="option" onclick="showSection('main-menu')">Back</button>
    <div id="load-msg"></div>
</div>

<div class="footer">
    This App was designed by Eli Anenburg and His AI friend
</div>

<script>
let words = []; // {english, hebrew, hidden, dateCreated}
let practiceList = [];
let currentWordIndex = 0;
let optionsVisible = false;

// Show section
function showSection(section) {
    document.querySelectorAll('.main-menu, .add-word, .practice, .practice-mode, .load-csv').forEach(s => s.style.display='none');
    document.querySelector('.'+section).style.display='block';
}

// Add word
function translateWord() {
    let word = document.getElementById('new-word').value.trim();
    if(!word) { alert("Enter word"); return; }
    // Simulate translation online
    document.getElementById('translated-word').value = word + " (Hebrew)";
}
function saveWord() {
    let english = document.getElementById('new-word').value.trim();
    let hebrew = document.getElementById('translated-word').value.trim();
    if(!english) { alert("Enter English word"); return; }
    words.push({english, hebrew, hidden:false, dateCreated: new Date().toISOString()});
    document.getElementById('add-word-msg').innerText = "Word saved!";
    document.getElementById('new-word').value = '';
    document.getElementById('translated-word').value = '';
}

// Practice
function startPractice() {
    let select = document.getElementById('practice-count').value;
    let maxWords = select==='all'? words.length : parseInt(select);
    maxWords = Math.min(maxWords, words.length);
    practiceList = words.filter(w=>!w.hidden).slice(-maxWords);
    currentWordIndex=0;
    showSection('practice-mode');
    displayWord();
}

function displayWord() {
    if(currentWordIndex >= practiceList.length){
        document.getElementById('practice-word').innerText = 'Practice Complete!';
        document.getElementById('practice-buttons').style.display='none';
        document.getElementById('options-container').innerHTML='';
        return;
    }
    let w = practiceList[currentWordIndex];
    document.getElementById('practice-word').innerText = w.english;
    document.getElementById('progress').innerText = (currentWordIndex+1) + '/' + practiceList.length;
    document.getElementById('options-container').innerHTML='';
    optionsVisible=false;
    enablePracticeButtons(true);
}

function enablePracticeButtons(enable) {
    document.querySelectorAll('#practice-buttons button').forEach(b=>{
        if(b.id==='speak-btn') return;
        b.disabled=!enable;
    });
}

function nextWord(type){
    if(type==='known'){
        // mark success logic
        currentWordIndex++;
        displayWord();
    }
}

// Show translation
function showTranslation(){
    let w = practiceList[currentWordIndex];
    alert("Translation: " + w.hebrew);
}

// Show options (multiple choice)
function showOptions(){
    let w = practiceList[currentWordIndex];
    optionsVisible=true;
    enablePracticeButtons(false);
    let container = document.getElementById('options-container');
    container.innerHTML='';
    let choices = [w.hebrew];
    while(choices.length<4){
        let rand = words[Math.floor(Math.random()*words.length)].hebrew;
        if(!choices.includes(rand)) choices.push(rand);
    }
    choices = choices.sort(()=>Math.random()-0.5);
    choices.forEach(c=>{
        let btn = document.createElement('button');
        btn.className='option';
        btn.innerText=c;
        btn.onclick = ()=>{
            if(c===w.hebrew) alert('Correct!');
            else alert('Wrong! Correct: '+w.hebrew);
            enablePracticeButtons(true);
        };
        container.appendChild(btn);
    });
}

// Hide word
function hideWord(){
    let w = practiceList[currentWordIndex];
    w.hidden=true;
    currentWordIndex++;
    displayWord();
}

// Edit current word
function editCurrentWord(){
    let w = practiceList[currentWordIndex];
    let eng = prompt("Edit English", w.english);
    let heb = prompt("Edit Hebrew", w.hebrew);
    if(eng!==null && heb!==null){
        w.english = eng;
        w.hebrew = heb;
        words.find(word=>word===w).english=eng;
        words.find(word=>word===w).hebrew=heb;
        displayWord();
    }
}

// Delete current word
function deleteCurrentWord(){
    let w = practiceList[currentWordIndex];
    if(confirm("Delete Word?")){
        words = words.filter(word=>word!==w);
        practiceList = practiceList.filter(word=>word!==w);
        displayWord();
    }
}

// Speak word
function speakWord(){
    let w = practiceList[currentWordIndex];
    let utter = new SpeechSynthesisUtterance(w.english);
    speechSynthesis.speak(utter);
}

// CSV Load
function loadCSV(){
    let file = document.getElementById('csv-file').files[0];
    if(!file) return;
    let reader = new FileReader();
    reader.onload = function(e){
        let lines = e.target.result.split('\n');
        lines.forEach((line,i)=>{
            if(i===0) return; // skip header
            let [english, hebrew] = line.split(',');
            if(english && !words.find(w=>w.english===english.trim())){
                words.push({english: english.trim(), hebrew: hebrew? hebrew.trim():'', hidden:false, dateCreated: new Date().toISOString()});
            }
        });
        document.getElementById('load-msg').innerText = 'CSV Loaded!';
    };
    reader.readAsText(file);
}

// CSV Export
function exportCSV(){
    let csv = 'English,Hewbrew,Is Hidden,Date Created\n';
    words.forEach(w=>{
        csv += `"${w.english}","${w.hebrew}",${w.hidden},"${w.dateCreated}"\n`;
    });
    let blob = new Blob([csv], {type: 'text/csv'});
    let url = URL.createObjectURL(blob);
    let a = document.createElement('a');
    let date = new Date().toISOString().slice(0,10);
    a.download = `MyWords_${date}.csv`;
    a.href = url;
    a.click();
}

showSection('main-menu');
</script>

</body>
</html>
