<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Words App</title>

<style>
body { font-family: Arial; background:#f8fafc; margin:0; }
.screen { display:none; padding:20px; max-width:600px; margin:auto; }
.screen.active { display:block; }
h1 { text-align:center; }
button { padding:14px; font-size:16px; border-radius:8px; border:none; margin:6px 0; }
.primary { background:#2563eb; color:#fff; }
.secondary { background:#e5e7eb; }
.danger { background:#dc2626; color:#fff; }
.card { background:#fff; padding:20px; border-radius:10px; }
.main-buttons button { width:60%; display:block; margin:10px auto; }
.word { font-size:32px; text-align:center; margin:20px 0; }
.translation { font-size:22px; text-align:center; color:#2563eb; }
.option { padding:12px; border-radius:8px; background:#f1f5f9; margin:6px 0; }
.correct { background:#dcfce7; }
.wrong { background:#fee2e2; }
.footer { font-size:12px; text-align:center; margin-top:40px; color:#475569; }
</style>
</head>

<body>

<!-- MAIN -->
<div class="screen active" id="main">
<h1>My Words App</h1>
<div class="main-buttons">
<button class="primary" onclick="go('add')">Add Word</button>
<button class="primary" onclick="go('practiceSetup')">Practice Words</button>
<button class="primary" onclick="exportCSV()">Export Word List</button>
<button class="danger" onclick="resetDB()">Reset Word Database</button>
</div>
<p style="text-align:center">Number of words in database: <b id="count"></b></p>
<div class="footer">This App was designed by Eli Anenburg and His AI friend</div>
</div>

<!-- ADD -->
<div class="screen" id="add">
<h1>Add Word</h1>
<div class="card">
<input id="e" placeholder="English" style="width:100%;padding:10px"><br><br>
<input id="h" placeholder="Hebrew" style="width:100%;padding:10px"><br><br>
<button class="primary" onclick="saveWord()">Save</button>
<button class="secondary" onclick="go('main')">Back</button>
</div>
</div>

<!-- PRACTICE SETUP -->
<div class="screen" id="practiceSetup">
<h1>Practice Setup</h1>
<div class="card">
<select id="limit" style="width:100%;padding:10px">
<option value="30">30 words</option>
<option value="50">50 words</option>
<option value="100">100 words</option>
<option value="200">200 words</option>
<option value="all">All words</option>
</select><br><br>
<label><input type="checkbox" id="resetCycle"> Reset Practice</label><br><br>
<button class="primary" onclick="startPractice()">Start Practice</button>
<button class="secondary" onclick="go('main')">Back</button>
</div>
</div>

<!-- PRACTICE -->
<div class="screen" id="practice">
<h1>Practice</h1>
<div class="card">
<div id="idx"></div>
<div class="word" id="word"></div>
<div class="translation" id="trans"></div>
<div id="opts"></div>
<button class="secondary" id="showT" onclick="showT()">Show Translation</button>
<button class="secondary" id="showO" onclick="showO()">Show Options</button>
<button class="primary" onclick="next()">Next Word</button>
<button class="secondary" onclick="go('main')">Finish Practice</button>
</div>
</div>

<script>
let words = JSON.parse(localStorage.words||"[]");
let queue=[], i=0, score=0;

function save(){ localStorage.words=JSON.stringify(words); count.innerText=words.length; }
save();

function go(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

function saveWord(){
if(!e.value||!h.value) return alert("Missing text");
words.unshift({e:e.value,h:h.value,shown:false});
save(); e.value=h.value=""; go('main');
}

function startPractice(){
if(document.getElementById('resetCycle').checked)
words.forEach(w=>w.shown=false);

let unseen=words.filter(w=>!w.shown);
if(unseen.length===0){
words.forEach(w=>w.shown=false);
unseen=[...words];
}

let lim=limit.value==="all"?unseen.length:+limit.value;
queue=unseen.slice(0,lim);
i=0; score=0;
load(); go('practice');
}

function load(){
let w=queue[i];
word.innerText=w.e;
trans.innerText="";
opts.innerHTML="";
idx.innerText=`${i+1}/${queue.length}`;
showT.disabled=false; showO.disabled=false;
}

function showT(){ trans.innerText=queue[i].h; showO.disabled=true; }

function showO(){
showT.disabled=true; showO.disabled=true;
let correct=queue[i].h;
let pool=words.map(w=>w.h).filter(x=>x!==correct).sort(()=>.5-Math.random()).slice(0,3);
pool.push(correct); pool.sort(()=>.5-Math.random());
pool.forEach(t=>{
let d=document.createElement('div');
d.className='option'; d.innerText=t;
d.onclick=()=>{
opts.querySelectorAll('.option').forEach(o=>o.onclick=null);
if(t===correct){ d.classList.add('correct'); score++; }
else{
d.classList.add('wrong');
[...opts.children].find(o=>o.innerText===correct).classList.add('correct');
}
};
opts.appendChild(d);
});
}

function next(){
queue[i].shown=true;
i++;
if(i>=queue.length){
if(words.every(w=>w.shown)){
alert(`Practice Completed\nCongratulations! All words in the database were covered.\nScore: ${score}/${queue.length}`);
words.forEach(w=>w.shown=false);
}else{
alert(`Practice Completed\nScore: ${score}/${queue.length}`);
}
save(); go('main'); return;
}
load();
}

function exportCSV(){
let csv="English,Hebrew\n";
words.forEach(w=>csv+=`"${w.e}","${w.h}"\n`);
let a=document.createElement('a');
a.href=URL.createObjectURL(new Blob([csv]));
a.download=`words_${new Date().toISOString().slice(0,10)}.csv`;
a.click();
}

function resetDB(){
if(confirm("Delete all words?")){
words=[]; save();
}
}
</script>

</body>
</html>
